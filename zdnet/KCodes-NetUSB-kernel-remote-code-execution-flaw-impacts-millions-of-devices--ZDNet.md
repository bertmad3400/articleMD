# KCodes NetUSB kernel remote code execution flaw impacts millions of devices | ZDNet
### The vulnerability is present in software licensed to multiple router vendors.

## Information:
+ Source: ZDNet
+ Link: https://www.zdnet.com/article/kcodes-netusb-kernel-remote-code-execution-flaw-impacts-millions-of-devices/
+ Date: 2022-01-11 12:00:08
+ Author: Charlie Osborne


## Article:
![Article Image](https://www.zdnet.com/a/img/resize/354250448adc2f06108e660f623f31797e217cd3/2021/05/27/ae72ce5c-0ff6-4c6a-8949-a3ca9192c76f/shutterstock-361393196.jpg?width=770&height=578&fit=crop&auto=webp)

A high-impact vulnerability allowing remote code execution to take place has impacted millions of end-user router devices. 


On Tuesday, [SentinelOne](https://www.sentinelone.com/labs/cve-2021-45608-netusb-rce-flaw-in-millions-of-end-user-routers) published an analysis of the bug, tracked as CVE-2021-45388 and deemed critical by the research team. 

The vulnerability impacts the KCodes NetUSB kernel module. KCodes solutions are licensed by numerous hardware vendors to provide USB over IP functionality in products including routers, printers, and flash storage devices.  

KCodes NetUSB, the subject of a SEC Consult [Vulnerability Lab analysis](https://sec-consult.com/blog/detail/kcodes-netusb-how-small-taiwanese/) in the past, is proprietary software used to facilitate these connections -- and the software is currently "used by a large number of network device vendors," of which the security flaws "affect millions of end-user router devices," according to SentinelOne.

Researcher Max Van Amerongen discovered the bug while examining a Netgear device. The kernel module, NetUSB, did not properly validate the size of packets fetched via remote connections, allowing a potential heap buffer overflow. 

According to Amerongen, although a malicious payload would be difficult to write to trigger CVE-2021-45388 due to coding restraints, an exploit could result in the remote execution of code in the kernel.  

SentinelOne says that vendors including Netgear, TP-Link, DLink, and Western Digital license the software, and all of them are now aware of the security flaw.  






The researchers disclosed their findings to KCodes directly on September 9, as it made more sense to inform the source who could then distribute a patch for everyone rather than just inform Netgear based on a single product test. A proof-of-concept patch was made available on October 4 and was sent to all vendors on November 17. 

Firmware updates, such as those detailed in the [advisory](https://kb.netgear.com/000064437/Security-Advisory-for-Pre-Authentication-Buffer-Overflow-on-Multiple-Products-PSV-2021-0278) issued by Netgear, have either been issued or are underway.  

At the time of writing, no exploitation has been discovered in the wild.  

"While we are not going to release any exploits for it, there is a chance that one may become public in the future despite the rather significant complexity involved in developing one," the researchers say.

###  Previous and related coverage

* [NoReboot attack fakes iOS phone shutdown to spy on you](https://www.zdnet.com/article/noreboot-attack-fakes-ios-phone-shutdown-to-spy-on-you/)
* [Purple Fox rootkit discovered in malicious Telegram installers](https://www.zdnet.com/article/purple-fox-rootkit-discovered-in-malicious-telegram-installers/)
* [JFrog researchers find JNDI vulnerability in H2 database consoles similar to log4shell](https://www.zdnet.com/article/jfrog-researchers-find-jndi-vulnerability-in-h2-database-consoles-similar-to-log4shell/)



---

**Have a tip?** Get in touch securely via WhatsApp | Signal at +447713 025 499, or over at Keybase: charlie0



---





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=Net]] [[action.malware.name=njRAT]] [[action.malware.name=Ping]] [[action.malware.name=Ping]] [[action.malware.name=route]] [[action.malware.name=Tor]]

#### Industry:
[[victim.industry.name=Mining]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Kcodes]] [[Netgear]] [[Netusb]] [[ZDNet]]
#### CVE's
[[CVE-2021-45388]]

