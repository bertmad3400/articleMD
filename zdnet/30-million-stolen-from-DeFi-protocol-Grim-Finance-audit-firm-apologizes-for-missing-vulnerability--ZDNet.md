# $30 million stolen from DeFi protocol Grim Finance, audit firm apologizes for missing vulnerability | ZDNet
### DeFi audit firm Solidity Finance said their CTO was on vacation when a new analyst missed a crucial vulnerability during an audit of Grim Finance four months ago.

## Information:
+ Source: ZDNet
+ Link: https://www.zdnet.com/article/30-million-stolen-from-defi-protocol-grim-finance-audit-firm-apologizes-for-missing-vulnerability/
+ Date: 2021-12-20 17:13:08
+ Author: Jonathan Greig


## Article:
![Article Image](https://www.zdnet.com/a/img/resize/c46186e5ea2ef1651c7ad218d89b762571422198/2021/10/15/ebba8479-c60e-4724-8f98-4647217826af/shutterstock-1253457799.jpg?width=770&height=578&fit=crop&auto=webp)

DeFi protocol Grim Finance said [about $30 million](https://ftmscan.com/address/0xdefc385d7038f391eb0063c2f7c238cfb55b206c) was stolen this weekend by hackers exploiting a vulnerability in their platform. 

In a statement [posted to Twitter](https://twitter.com/financegrim/status/1472351539255783426) on Saturday, Grim Finance said "an advanced attack" was taking place and initially paused all vaults to prevent more attacks. 

"The exploit was found in the vault contract so all of the vaults and deposited funds are currently at risk," the company [explained](https://twitter.com/financegrim/status/1472357770846519312) on Saturday night. "We have contacted and notified Circle (USDC), DAI, and AnySwap regarding the attacker address to potentially freeze any further fund transfers."

Solidity Finance, a DeFi auditing firm, released an apology for missing the vulnerability that led to the incident. They audited Grim Finance just four months ago. 

The company [said](https://solidity.finance/audits/GrimVault/) the cause of the issue was "the ability of users to input arbitrary addresses and have them called within the depositFor function." 

"Via reentrancy, the issue allowed users to falsely increase their shares in Grim's vaults and subsequently withdraw more than they had deposited," Solidity Finance wrote on their website before linking to a [longer Twitter thread](https://twitter.com/SolidityFinance/status/1472614849230344196) where they said a new analyst missed the vulnerability while their CTO was on vacation. 

"When conducting the Grim Finance audit ~4 months ago, our firm was experiencing rapid growth and hiring. This audit was performed by an analyst who was new to the team and while our CTO was on vacation; and unfortunately this issue was not caught in our peer review process."






The thread goes on to explain the technical details of the attack and said the code that was exploited was present in multiple vaults, resulting in a loss of funds across the platform's vaults.

Some [DeFi security experts noted](https://twitter.com/RugDocIO/status/1472293712185151492) that having a before-after pattern without reentrancy guard "is a big no-no." RugDoc.io explained that a "before-after pattern is a section of code that checks the vault balance before and after your deposit to figure out how much was actually received by the vault."

"This helps with transfer-tax tokens where the amount sent does not equal the amount received. However, what happens if we can do a second deposit while the first deposit is still ongoing?" RugDoc.io wrote, adding that Grim Finance did not have a "reentrancy guard on a pattern that absolutely needs it" and gave users more privilege than is necessary.  

Solidity Finance said they regularly recommend fixing the issue but it "slipped through" their process while they were "overwhelmed and onboarding new analysts in August."

They have scanned all of their earlier audits and confirmed that Grim Finance had the only codebase where the vulnerability was present. Of the 900 audits they've done, Grim becomes the second exploit that they have missed, according to their records. 

The attack on Grim Finance adds to [a whirlwind year](https://www.yahoo.com/now/defi-protocols-lost-680-million-080029676.html) for DeFi hacks. Last week, [more than $77 million](https://www.zdnet.com/article/after-77-million-hack-crypto-platform-ascendex-to-reimburse-customers/) was stolen from AscendEX and days before that, blockchain gaming company Vulcan Forged [said](https://twitter.com/VulcanForged/status/1470201106626224140) around $140 million had been stolen from their users.

Crypto trading platform BitMart [suffered from a devastating attack](https://support.bmx.fund/hc/en-us/articles/4411998987419) that caused [about $200 million in losses](https://www.zdnet.com/article/bitmart-breach-losses-reach-200-million/).

Just last month, cybercriminals [stole about $120 million](https://twitter.com/peckshield/status/1466356911842856967) from DeFi platform [Badger](https://therecord.media/hackers-steal-120-million-from-badger-defi-platform/). Other attacks in 2021 include thefts of more than [$600 million from Poly](https://www.zdnet.com/article/poly-network-hackers-potentially-stole-610-million-is-bitcoin-still-safe/) in August and [$34 million from Cream Finance](https://www.zdnet.com/article/cream-finance-wallet-pilfered-for-34-million-in-cryptocurrency/) in September. In May, about $200 million was stolen from the PancakeBunny platform. 

[The Record](https://therecord.media/bitmart-loses-150-million-in-the-second-largest-crypto-heist-of-the-year/) and [Comparitech](https://www.comparitech.com/crypto/biggest-cryptocurrency-heists/) keep running tallies of cyberattacks on cryptocurrency platforms, noting recent [attacks on Liquid](https://www.zdnet.com/article/more-than-97-million-stolen-from-liquid-cryptocurency-exchange/), EasyFi, bZx, and many other platforms. 





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=Reg]]

#### Industry:
[[victim.industry.name=Finance]]

#### Location:
[[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[]] [[ZDNet]]

