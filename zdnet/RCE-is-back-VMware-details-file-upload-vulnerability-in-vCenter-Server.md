# RCE is back: VMware details file upload vulnerability in vCenter Server
### Once again, if a malicious actor can hit port 443 on vCenter Server, it's goodnight nurse.

## Information:
+ Source: ZDNet
+ Link: [article](https://www.zdnet.com/article/rce-is-back-vmware-details-file-upload-vulnerability-in-vcenter-server/)
+ Date: September 22, 2021
+ Author: Chris Duckett


## Article:
Unknown

![vmware.jpg](https://www.zdnet.com/a/hub/i/r/2021/06/09/f0d855e4-b54a-43db-96d0-673268c39e8f/resize/1200xauto/1ca308fd9e40ced690d94e46a7d955c3/vmware.jpg)
 Image: Shutterstock
 If you haven't patched vCenter in recent months, please do so at your earliest convenience. 

Following on from its [remote code execution hole](https://www.zdnet.com/article/patch-immediately-vmware-warns-of-critical-remote-code-execution-holes-in-vcenter/) in vCentre in May, VMware has warned of a critical vulnerability in the analytics service of vCenter Server. 

"A file upload vulnerability that can be used to execute commands and software on the vCenter Server Appliance. This vulnerability can be used by anyone who can reach vCenter Server over the network to gain access, regardless of the configuration settings of vCenter Server," the company said in a [blog post](https://core.vmware.com/vmsa-2021-0020-questions-answers-faq). 

Handed the label CVE-2021-22005, the vulnerability hit a CVSSv3 score of 9.8, and means a malicious actor only needs to access port 443 and have a file to upload that is capable to exploiting an unpatched server. 

The vulnerability hits versions 6.7 and 7.0 of vCenter Server Appliances, with builds greater than 7.0U2c build 18356314 from August 24 and 6.7U3o build 18485166 released on September 21 patched. The exploit does not impact vCenter 6.5 versions. 

For those looking for a workaround instead of applying a patch, VMware has [issued instructions](https://kb.vmware.com/s/article/85717). The workaround will be reverted once the server instance is patched. 

VMware said users should patch immediately. 






"The ramifications of this vulnerability are serious and it is a matter of time -- likely minutes after the disclosure -- before working exploits are publicly available," it said. 

Other vulnerabilities addressed in [VMware's advisory](https://www.vmware.com/security/advisories/VMSA-2021-0020.html) included CVE-2021-21991, a CVSSv3 8.8 local privilege escalation involving session tokens that would see users gain administrator access; CVE-2021-22006, a CVSSv3 8.3 reverse proxy bypass that could allow access to restricted endpoints; and CVE-2021-22011 that could allow for unauthenticated VM network setting manipulation. 

All up, of the 19 vulnerabilities listed in its advisory, 10 were found by George Noseevich and Sergey Gerasimov of SolidLab. 

Elsewhere, Claroty Team 82 [detailed](https://claroty.com/2021/09/21/blog-research-securing-network-management-systems-nagios-xi/) how it chained together a number of vulnerabilities in Nagios XI to gain a reverse shell with root remote code execution. 

Although 11 vulnerabilities were found -- four of which were handed a CVSSv3 score of 9.8 and included an SQL injection -- only two were needed for the reverse shell: CVE-2021-37343, a path traversal vulnerability that allows for code to be executed as the Apache user; and CVE-2021-37347 that allows for local privilege escalation. 

The auto login feature of Nagios XI that allows for read-only access to the Nagios dashboard without credentials greatly expanded the attack surface, Team 82 said. 

"While this feature might be useful for NOC purposes, allowing users to easily connect to the platform and view information without the need for credentials also allows attackers to gain access to a user account in the platform, thus rendering any post-auth vulnerability exploitable without authentication," they said. 

Patched versions of vulnerable Nagios XI products were released in August.

![claroty-team82-nagios-reverse-shell-root.gif]()![claroty-team82-nagios-reverse-shell-root.gif](https://www.zdnet.com/a/hub/i/2021/09/22/2d978e8c-d321-490a-9367-6306ff6efc05/claroty-team82-nagios-reverse-shell-root.gif)One reverse root shell coming up


 Image: Claroty
 ### Related Coverage

* [Patch immediately: VMware warns of critical remote code execution hole in vCenter](/article/patch-immediately-vmware-warns-of-critical-remote-code-execution-holes-in-vcenter/)
* [Critical remote code execution flaw in thousands of VMWare vCenter servers remains unpatched](/article/critical-remote-code-execution-flaw-in-thousands-of-vmware-vcenter-servers-remains-unpatched/)
* [Patch now: Attackers are hunting for this critical VMware vCentre flaw](/article/patch-now-attackers-are-hunting-for-this-critical-vmware-vcentre-flaw/)
* [Get patching: US, UK, and Australia issue joint advisory on top 30 exploited vulnerabilities](/article/get-patching-us-uk-and-australia-issue-joint-advisory-on-top-30-exploited-vulnerabilities/)
* [Ransomware gangs are abusing VMWare ESXi exploits to encrypt virtual hard disks](/article/ransomware-gangs-are-abusing-vmware-esxi-exploits-to-encrypt-virtual-hard-disks/)





#### Tags:
[[vCenter]] [[VMware]] [[CVSSv3]] [[Nagios]] [[said.]] [[ZDNet]]
