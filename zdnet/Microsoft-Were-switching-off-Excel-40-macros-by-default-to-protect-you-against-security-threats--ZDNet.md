# Microsoft: We're switching off Excel 4.0 macros by default to protect you against security threats | ZDNet
### Microsoft has enabled a new setting that disables legacy Excel 4.0 macros by default.

## Information:
+ Source: ZDNet
+ Link: https://www.zdnet.com/article/microsoft-were-switching-off-excel-4-0-macros-by-default-to-protect-you-against-security-threats/
+ Date: 2022-01-24 11:57:09
+ Author: Liam Tung


## Article:
![Article Image](https://www.zdnet.com/a/img/resize/7fc52596c16017271617c0967f55df15e553c6b7/2022/01/24/be81c3ce-d788-45b8-9fde-5903e1dd1ab7/shutterstock-1577529058.jpg?width=770&height=578&fit=crop&auto=webp)

Microsoft has disabled Excel 4.0 macros by default in the latest release of its spreadsheet software to help customers protect themselves against related security threats.

That setting, released as an optional configuration in Excel Trust Center setting in July, is now the default when opening Excel 4.0 macros (XLM), [Microsoft said in a blogpost](https://techcommunity.microsoft.com/t5/excel-blog/excel-4-0-xlm-macros-now-restricted-by-default-for-customer/ba-p/3057905). 


A macro is a series of commands that you can use to automate a repeated task, and can be run when you have to perform the task. But unexpected macros can pose a significant security risk. You don't have to enable macros to see or edit the file; only if you want the functionality provided by the macro. But crooks will try to trick the unwary into enabling macros and then using that functionality as part of their attacks.

**SEE:** [**Windows 11: Here's how to get Microsoft's free operating system update**](https://www.zdnet.com/article/windows-11-heres-how-to-get-microsofts-free-operating-system-update/#link=%7B%22linkText%22:%22Windows%2011:%20Here's%20how%20to%20get%20Microsoft's%20free%20operating%20system%20update%22,%22target%22:%22_blank%22,%22href%22:%22https://www.zdnet.com/article/windows-11-heres-how-to-get-microsofts-free-operating-system-update/%22,%22role%22:%22standard%22,%22absolute%22:%22%22%7D)

The move to restrict Excel 4.0 macros is an attempt to counter a rise in ransomware and other malware groups [using Excel 4.0 macros as part of an initial infection](https://www.zdnet.com/article/this-decade-old-malware-has-picked-up-some-nasty-new-tricks/). State-sponsored and cybercriminal attackers [started experimenting with legacy Excel 4.0 macros](https://www.zdnet.com/article/microsoft-were-cracking-down-on-malware-that-uses-excel-macros/) in response to Microsoft in 2018 cracking down on macro scripts written in Visual Basic for Applications (VBA).  

The initial Excel Trust Center settings targeted organizations that wanted VBA and legacy XL macros to run via the setting "Enable Excel 4.0 macros when VBA macros are enabled". This allowed admins to control the behavior of XL macros without impacting VBA macros.  

XL macros are now disabled by default in Excel in build 16.0.14427.10000 and later. Admins can still configure the setting in Microsoft 365 applications policy control. 






Microsoft has added some new policy settings options to the original Group Policy settings that were made available in July.  

Now there is also the option to manage the policy setting in the Office cloud policy service, which is applied to users who access Office apps from any device with their Active Azure Directory (AAD) account. The policy can also be managed from Microsoft Endpoint Manager. 

To block XML across the board, including new files created by users, admins can set Group Policy to "Prevent Excel from running XLM". This can be done via Group Policy Editor or registry key.   

This should help admins mitigate VBA and XLM malware threats using policy. Microsoft has addressed the antivirus side of defense via an integration between its Antimalware Scan Interface ([AMSI](https://docs.microsoft.com/en-us/windows/win32/amsi/antimalware-scan-interface-portal)) and Office 365 that Defender and third-party antivirus can integrate with. 

The AMSI-Office 365 integration allowed scanning of Excel 4.0 macros at runtime last year, bringing it in line with the same runtime scanning capability for VBA macros in 2018. Basically, when VBA runtime scanning for Excel arrived, [attackers moved to older XL-based macros](https://www.zdnet.com/article/microsoft-were-cracking-down-on-malware-that-uses-excel-macros/), which they knew organizations still used for legitimate purposes and were powerful enough to call Win32 interfaces and run shell commands.





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=njRAT]] [[action.malware.name=Reg]] [[action.malware.name=Tor]]

#### Location:
[[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Microsoft]] [[Vba]] [[Xl]] [[Admins]] [[ZDNet]]

