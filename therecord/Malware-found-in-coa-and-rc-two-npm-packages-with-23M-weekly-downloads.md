# Malware found in coa and rc, two npm packages with 23M weekly downloads
### 

## Information:
+ Source: The Record
+ Link: [article](https://therecord.media/malware-found-in-coa-and-rc-two-npm-packages-with-23m-weekly-downloads/)
+ Date: November 5, 2021
+ Author: Catalin Cimpanu


## Article:
![Malware found in coa and rc, two npm packages with 23M weekly downloads](https://therecord.media/wp-content/uploads/2021/11/npm-logo.png)

The security team of the **npm** JavaScript package manager has warned users that two of its most popular packages had been hijacked by a threat actor who released new versions laced with what appeared to be password-stealing malware.


* Affected packages include [coa](https://github.com/veged/coa/issues/99) and [rc](https://github.com/dominictarr/rc/issues/131).
* [**Coa**](https://www.npmjs.com/package/coa) is a command-line argument parser with ~8.8 million weekly downloads.
* [**Rc**](https://www.npmjs.com/package/rc) is a configuration loader with ~14.2 million weekly downloads.
* **Compromised coa versions:** 2.0.3, 2.0.4, 2.1.1, 2.1.3, 3.0.1, 3.1.3
* **Compromised rc versions:** 1.2.9, 1.3.9, 2.3.9.


Both packages were compromised around the same time and were the result of attackers gaining access to a package developer’s account.


Once inside, the threat actor added a post-installation script to the original codebase, which it run a[n obfuscated TypeScript](https://my.diffend.io/npm/coa/2.0.2/2.0.4), that would check for operating system details and download a Windows batch or Linux bash script.


According to a [deobfuscated version](https://github.com/veged/coa/issues/99#issuecomment-960989137) of the [Windows batch script](https://www.virustotal.com/gui/file/687a401007c29ee595004d93c4dd5de6c5c9f86f811f8e1d9f1ad1962507cd65/detection), the compromised packages would download and run a DLL file that, according to Windows Defender, and others, contained a version of the Qakbot trojan.


![coa-script](https://www-therecord.recfut.com/wp-content/uploads/2021/11/coa-script.png)
Initially, the coa compromise was spotted first after its new installation routine [started crashing build pipelines](https://news.ycombinator.com/item?id=29107298) for React-based applications.


“The compromised [developer] account has been temporarily disabled and we are actively investigating the incident and monitoring for similar activity,” [the npm team said on Thursday](https://twitter.com/npmjs/status/1456310627362742284), shortly after detecting the coa compromise following a wave of reports about failed builds.





The compromise of the rc package was discovered [hours later](https://twitter.com/npmjs/status/1456398505832976384).


Since then, the npm security team has removed all the compromised coa and rc versions to prevent developers from accidentally infecting themselves.


However, both compromises had no chance of slipping through. Both libraries are extremely widely used, the malicious code was poorly hidden, and both libraries hadn’t seen new releases since [December 2018](https://github.com/veged/coa/tags) and [December 2015](https://github.com/dominictarr/rc/tags), respectively, meaning that any new release would have triggered a security audit for most professional developer teams.


As it was pointed out on GitHub yesterday, the malicious code involved in these incidents is almost identical to the one used in the [compromise of the UAParser library](https://therecord.media/malware-found-in-npm-package-with-millions-of-weekly-downloads/) in late October.





#### Tags:
[[coa]] [[npm]] [[Windows]] [[The Record]]
