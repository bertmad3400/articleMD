# GitLab servers are being exploited in DDoS attacks in excess of 1 Tbps
### 

## Information:
+ Source: The Record
+ Link: [article](https://therecord.media/gitlab-servers-are-being-exploited-in-ddos-attacks-in-excess-of-1-tbps/)
+ Date: November 4, 2021
+ Author: Catalin Cimpanu


## Article:
![GitLab servers are being exploited in DDoS attacks in excess of 1 Tbps](https://therecord.media/wp-content/uploads/2021/11/GitLab.png)

Threat actors are exploiting a security flaw in GitLab self-hosted servers to assemble botnets and launch gigantic distributed denial of service (DDoS) attacks, with some in excess of 1 terabit per second (Tbps).


The DDoS attacks, disclosed today by Damian Menscher, a Security Reliability Engineer at Google Cloud responsible for Google’s DDoS defenses, are exploiting [CVE-2021-22205](https://nvd.nist.gov/vuln/detail/CVE-2021-22205), a vulnerability that GitLab [patched back in April 2021](https://about.gitlab.com/releases/2021/04/14/security-release-gitlab-13-10-3-released/).


### Attacks target GitLab’s metadata removal feature


Discovered by William Bowling and reported to GitLab via its bug bounty program, the vulnerability impacts [ExifTool](https://exiftool.org/)—a library used to remove metadata from images uploaded on web servers.


Under the hood, GitLab uses ExifTool inside GitLab Community Edition (CE) and Enterprise Edition (EE), the open-source and commercial versions of its service that companies can install on their own servers—for scenarios where they want to handle proprietary code in secure environments and can’t use GitLab’s cloud-based service.


In a [report](https://hackerone.com/reports/1154542) filed via HackerOne, Bowling said he discovered a way to abuse how ExifTool handles uploads for [DjVu](https://en.wikipedia.org/wiki/DjVu) file format used for scanned documents to gain control over the entire underlying GitLab web server.


Attacks exploiting this vulnerability began in June this year, according to Italian security firm HN Security, who [first reported signs of exploitation last week](https://security.humanativaspa.it/gitlab-ce-cve-2021-22205-in-the-wild/).


At the time, HN security researcher Piergiovanni Cipolloni said the company began an investigation after spotting randomly-named users being added to compromised GitLab servers, users that were most likely created by the attackers to allow remote control of the hacked systems.


![HN-GitLab-users](https://www-therecord.recfut.com/wp-content/uploads/2021/11/HN-GitLab-users.png)Image: HN Security
While the purpose of these attacks remained unclear for HN Security, yesterday, Google’s Menscher said the hacked servers were part of a botnet comprising of “thousands of compromised GitLab instances” that was launching large-scale DDoS attacks.





### Around 30,000 GitLab servers remain unpatched


Just as seen in many other previous cases, the botnet operators appear to be exploiting the tardiness of companies across the world when it comes to patching their software, in this case, in-house GitLab servers.


According to a [Rapid7 analysis](https://www.rapid7.com/blog/post/2021/11/01/gitlab-unauthenticated-remote-code-execution-cve-2021-22205-exploited-in-the-wild/) published on Monday, there are more than 60,000 GitLab servers connected to the internet, of which around half still remain unpatched for the CVE-2021-22205 ExifTool exploit.


[Public proof-of-concept code](https://github.com/CsEnox/Gitlab-Exiftool-RCE) for this vulnerability has been available since June, around the same time that HN spotted the first attacks.


Of note is that the ExifTool vulnerability at the core of the GitLab issue, tracked independently as [CVE-2021-22204](https://nvd.nist.gov/vuln/detail/CVE-2021-22204), might also impact other types of web applications where the tool might have been deployed, so it may be that additional exploitation is also likely reported, and that other types of web apps might need patching as well.


The simplest way to prevent attacks would be to block the upload of DjVu files at the server level, if companies don’t need to handle this file type.





#### Tags:
[[GitLab]] [[HN]] [[ExifTool]] [[DDoS]] [[The Record]]
