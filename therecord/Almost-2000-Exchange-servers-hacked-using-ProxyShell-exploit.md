# Almost 2,000 Exchange servers hacked using ProxyShell exploit
### 

## Information:
+ Source: The Record
+ Link: [article](https://therecord.media/almost-2000-exchange-servers-hacked-using-proxyshell-exploit/)
+ Date: August 21, 2021
+ Author: Catalin Cimpanu


## Article:
![Almost 2,000 Exchange servers hacked using ProxyShell exploit](https://therecord.media/wp-content/uploads/2021/08/web-shell.png)

Almost 2,000 Microsoft Exchange email servers have been hacked over the past two days and infected with backdoors after owners did not install patches for a collection of vulnerabilities known as **ProxyShell**.


The attacks, detected by security firm Huntress Labs, come after proof-of-concept exploit code was published online [earlier](https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1)[this month](https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1), and scans for vulnerable systems began last week.


#### What is ProxyShell?


Discovered by Taiwanese security researcher Orange Tsai, ProxyShell is a collection of three different security flaws that can be used to take control of Microsoft Exchange email servers. These include:


* [CVE-2021-34473](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473) provides a mechanism for pre-authentication remote code execution, enabling malicious actors to remotely execute code on an affected system.
* [CVE-2021-34523](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523) enables malicious actors to execute arbitrary code post-authentication on Microsoft Exchange servers due to a flaw in the PowerShell service not properly validating access tokens.
* [CVE-2021-31207](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207) enables post-authentication malicious actors to execute arbitrary code in the context of SYSTEM and write arbitrary files.


In the grand scheme of things, ProxyShell is part of a trio of attack chains that Tsai has discovered and put together over the past year since he first began searching for vulnerabilities in Microsoft Exchange servers in mid-2020:


* [ProxyLogon](https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html)
* [ProxyOracle](https://blog.orange.tw/2021/08/proxyoracle-a-new-attack-surface-on-ms-exchange-part-2.html)
* [ProxyShell](https://www.zerodayinitiative.com/blog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell)


Tsai used the ProxyShell exploit during the Pwn2Own 2021 hacking contest in April this year, where he earned $200,000 for a successful server compromise.


#### More than 30,400 Exchange servers exposed to attacks


Following his session, details about the exploit were immediately shared with Microsoft, and the company patched the three vulnerabilities in May and July this year.


But just like with the ProxyLogon and ProxyOracle disclosures in March and April this year, not all server administrators rushed to patch vulnerable systems.


A scan performed on August 8 by ISC SANS, two days after the ProxyShell proof-of-concept code was published, found that [more than 30,400 Exchange servers](https://isc.sans.edu/forums/diary/ProxyShell+how+many+Exchange+servers+are+affected+and+where+are+they/27732/) from a total of 100,000 systems had yet to be patched and remained vulnerable to attacks.


#### 1,900+ Exchange servers already hacked


Initial exploitation started with scans for vulnerable systems, which then turned into actual attacks over the past weekend, according to honeypot logs collected by security researchers [Rich Warren](https://twitter.com/buffaloverflow/status/1425831100157349890) and [Kevin Beaumont](https://twitter.com/GossiTheDog/status/1425844380376735746).


Attacks intensified this week, and even a new ransomware operation known as LockFile began using the ProxyShell exploit as a way to enter corporate networks.


 
On Friday, security firm Huntress Labs said it scanned Microsoft Exchange servers that have been hacked using ProxyShell and found more than 140 different web shells on more than 1,900 Exchange servers.


“Impacted organizations thus far include building mfgs, seafood processors, industrial machinery, auto repair shops, a small residential airport, and more,” said Kyle Hanslovan, CEO and co-founder of Huntress Labs.





Making matters worse, earlier this week, a user on a Russian-speaking underground cybercrime forum also published a list of all the 100,000+ internet-accessible Exchange servers, lowering the barrier so even more threat actors can just grab the public exploit and start attacking Exchange servers within minutes.


![Exchange-server-list](https://www-therecord.recfut.com/wp-content/uploads/2021/08/Exchange-server-list-1024x482.png)Image: The Record
To help system administrators investigate their Exchange servers, Huntress Labs has [released indicators of compromise (IOCs)](https://www.huntress.com/blog/rapid-response-microsoft-exchange-servers-still-vulnerable-to-proxyshell-exploit).


Readers looking to learn more about the ProxyShell vulnerabilities can read Tsai’s technical report linked above or watch his Def Con talk embedded below.











#### Tags:
[[ProxyShell]] [[Microsoft]] [[The Record]]
