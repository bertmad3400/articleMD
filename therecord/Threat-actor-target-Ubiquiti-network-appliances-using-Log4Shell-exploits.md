# Threat actor target Ubiquiti network appliances using Log4Shell exploits
### Threat actors are using a customized public exploit for the Log4Shell vulnerability to attack and take over Ubiquiti network appliances running the UniFi software, security firm Morphisec said in a report last week.

## Information:
+ Source: The Record
+ Link: https://therecord.media/threat-actor-target-ubiquiti-network-appliances-using-log4shell-exploits/
+ Date: 2022-01-31T19:28:05+00:00
+ Author: Catalin Cimpanu


## Article:
![Article Image](https://therecord.media/wp-content/uploads/2022/01/UniFi.jpg)

Threat actors are using a customized public exploit for the Log4Shell vulnerability to attack and take over Ubiquiti network appliances running the UniFi software, security firm Morphisec said in a [report](https://blog.morphisec.com/log4j-exploit-targets-vulnerable-unifi-network-applications) last week.


* The first active exploitation was seen on January 20, 2022.
* The attackers used a proof-of-concept exploit previously shared [on GitHub](https://github.com/puzzlepeaches/Log4jUnifi).
* Developed the Sprocket Security, the PoC adapts the Log4Shell exploit in the Log4j Java library to work on Ubiquiti’s UniFi devices, complete with [post-exploitation steps](https://www.sprocketsecurity.com/blog/another-log4j-on-the-fire-unifi).


Developed by Ubiquiti Networks, one of the largest hardware vendors in the world, the [UniFi](https://help.ui.com/hc/en-us/articles/1500012237441-UniFi-Network-Use-the-UniFi-Network-Application) software can be installed on Linux and Windows servers and allow network administrators to manage Ubiquiti wireless and networking equipment from a centralized web-based application.


This application was built using Java and utilized the Log4j library for its logging capabilities and was listed as impacted by the Log4Shell, having received a [patch](https://community.ui.com/releases/UniFi-Network-Application-6-5-54/d717f241-48bb-4979-8b10-99db36ddabe1) on December 10, just a day after the Log4Shell news became made public.


While Sprocket Security published its adaptation of the Log4Shell attack for UniFi devices in late December, attacks haven’t been seen in the wild until Morphisec’s public report last Friday.


Morphisec said the attackers took over UniFi devices and ran malicious PowerShell code that later downloaded and installed a version of the Cobalt Strike Beacon backdoor.


Researchers noted that this malware communicated with a command and control server that was previously seen attacking [SolarWinds Serv-U servers](https://therecord.media/microsoft-discovers-a-solarwinds-zero-day-exploited-in-the-wild/) before the Log4Shell attacks.


### Log4j attacks ramping up slowly


Immediately after the Log4Shell vulnerability was disclosed, many security experts warned that attacks using this bug would ramp up and lead to some sort of internet catastrophe and a huge hacking spree.


Almost two months later, this has yet to happen, primarily because exploiting Log4Shell didn’t turn out to be that simple. Because the library was implemented differently in each app that used it, there was no universal exploit code that worked everywhere out-of-the-box and granted attackers the ability to take over systems indiscriminately.


For each software they would want to attack, threat actors had to reverse engineer the code and see how the exploit needed to be adapted, a very complex, complicated, and time-consuming job that threat actors rarely bother with.


Instead, attackers relied on public exploits shared online, and two months later, reports of Log4Shell exploitation have been limited only to a handful of devices, such as [VMWare Horizon](https://therecord.media/uk-nhs-threat-actor-targets-vmware-horizon-servers-using-log4shell-exploits/), [VMWare vCenter](https://therecord.media/conti-ransomware-group-adopts-log4shell-exploit/), [ZyXEL routers](https://www.akamai.com/blog/security/mirai-botnet-abusing-log4j-vulnerability), and [SolarWinds Serv-U](https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/#CVE-2021-35247) servers. MobileIron has escaped attacks, despite a [public PoC](https://github.com/rwincey/CVE-2021-44228-Log4j-Payloads/blob/main/MobileIron)—for now.





## Tags:

#### Threatactor:
[[threatactor.name=Rocke]]

#### Action:
[[action.malware.name=at]] [[action.malware.name=Cobalt Strike]] [[action.malware.name=Net]] [[action.malware.name=Ping]] [[action.malware.name=Ping]] [[action.malware.name=route]] [[action.malware.name=Tor]]

#### Industry:
[[victim.industry.name=Information]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Log4shell]] [[Unifi]] [[Ubiquiti]] [[Morphisec]] [[Log4j]] [[The Record]]

