# T-Reqs – A Tool For HTTP Request Smuggling (HRS) attacks
### T-Reqs tool employs grammar-based differential fuzzing to spot novel bugs triggering HTTP Request Smuggling attacks.

## Information:
+ Source: Latest Hacking News
+ Link: https://latesthackingnews.com/2021/11/30/t-reqs-a-tool-for-http-request-smuggling-hrs-attacks/
+ Date: 2021-11-30
+ Author: Abeerah Hashim


## Article:
![Article Image](https://latesthackingnews.com/wp-content/uploads/2021/11/bug.jpg)
 A team of academic researchers have developed a new HTTP fuzzing tool called ‘T-Reqs’. This tool employs deferential fuzzing to spot vulnerabilities. The researchers believe T-Reqs can significantly help the security community in identifying potential HTTP Request Smuggling triggers.

 T-Reqs Fuzzing Tool
-------------------

 Researchers have proposed a new fuzzing tool to contain [HTTP Request Smuggling](https://latesthackingnews.com/2017/11/26/crlf-injection-attack/) (HRS) attacks. While HRS isn’t new (first appeared in 2005), it is gaining traction as more vulnerabilities surface online, leading to real-life exploits.

 Specifically, HRS exploits HTTP processing differences by two servers. As the researchers described,

 
> HRS stems from a discrepancy between the HTTP processing behaviors of two servers that process the same request on the traffic path. These servers could be any technology that intercepts, parses, interprets, or forwards the request, including CDNs, stand-alone proxies, web caches, load balancers, or security products.
> 
> 

 Briefly, attackers abuse HRS to “smuggle hidden requests through the proxy”. That’s what the researchers’ new tool “T-Reqs” addresses.

 In short, T-Reqs (**T**wo-**Req**uest**s**) tool employs differential fuzzing (in simple words, a technique that provides the same input to multiple similar apps to then assess the differences in the execution) to find HRS vulnerabilities. The researchers have built it over *context-free grammar* (CFG) to generate HTTP requests to test all relevant components of target servers. After sending the same input, assessing the discrepancies in the responses can help [identify bugs](https://latesthackingnews.com/2018/10/12/windows-10-october-2018-update-release-halt-bug-identified-fix/) potentially triggering HRS attacks.

 T-Reqs isn’t the first tool in this context. Numerous other tools already exist to test sites for HRS bugs. However, T-Reqs works differently. While the other tools like the Burp Suite extension HTTP Request Smuggler help in [penetration testing](https://aardwolfsecurity.com/), T-Reqs doesn’t work on live websites. Instead it typically works in a lab setup to detect novel HRS bugs (instead of the known ones).

 
> T-Reqs tests pairwise combinations of HTTP processors in a lab environment, and exercises each component individually, in a greybox manner. It is designed to discover novel HRS vectors, as opposed to testing a real-life deployment for known attacks.
> 
> 

 Hence, in real-world applications, this tool can work on top of the existing pen-testing tools. T-Reqs’ findings can make the other tools assess target systems based on the newly discovered bugs too.

 The researchers have shared the details about their study and T-Reqs in a [white paper](https://bahruz.me/papers/ccs2021treqs.pdf). Whereas the tool is available for the public on [GitHub](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer).

 Let us know your thoughts in the comments.

   


## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=Net]] [[action.malware.name=Tor]]

#### Location:
[[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[T-reqs]] [[Http]] [[Latest Hacking News]]

