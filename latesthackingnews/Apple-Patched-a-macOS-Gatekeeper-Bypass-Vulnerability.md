# Apple Patched a macOS Gatekeeper Bypass Vulnerability
### Exploiting the Gatekeeper bypass flaw could allow malicious apps to execute on macOS. Apple fixed the bug with macOS Big Sur 11.6.

## Information:
+ Source: Latest Hacking News
+ Link: https://latesthackingnews.com/2021/12/28/apple-patched-a-macos-gatekeeper-bypass-vulnerability/
+ Date: 2021-12-28
+ Author: Abeerah Hashim


## Article:
![Article Image](https://latesthackingnews.com/wp-content/uploads/2018/11/Apple-patched-multiple-XNU-kernel-vulnerabilities.jpg)
 The Cupertino giant has addressed a severe Gatekeeper bypass vulnerability affecting macOS devices. Exploiting the flaw could allow attackers to deploy malicious apps even on fully-patched systems.

 macOS Gatekeeper Bypass Flaw
----------------------------

 Elaborating on the vulnerability in a [blog post](https://objective-see.com/blog/blog_0x6A.html), Patrick Wardle highlighted how the Gatekeeper bypass flaw risked macOS security.

 Gatekeeper is a security check feature in macOS that validates [app notarization](https://latesthackingnews.com/2020/10/26/malicious-apps-repeatedly-bypassed-apple-app-notarization/) and developer signature for incoming apps. These security measures ensure [keeping malicious apps and malware away from macOS](https://latesthackingnews.com/2021/08/09/is-malware-still-a-threat-to-a-mac-in-2021/).

 As described, the vulnerability, CVE-2021-30853, first caught the attention of [Gordon Long](https://twitter.com/ethicalhax). Briefly, this bug could allow an unsigned, un-notarized app to run on a target device.

 While Wardle has explained the bug and the PoC exploit in detail in his post, summarizing the issue, he stated,

 
> -When a script-based application with no specified interpreter is launched, execution initially fails with ENOEXEC. This causes the script to be (re)executed via `/bin/sh`.  
>  -As `/bin/sh` is a Mach-O (not a script), no script labels are set. Thus the script is never evaluated (nor blocked) by `syspolicyd`.  
>  The policy engine just sees `/bin/sh` (a trusted platform binary), and thus allows it to execute. Of course `/bin/sh` then executes the PoC script.
> 
> 

 That’s the exact vulnerability – the unsigned PoC gets executed despite lacking notarization.

 Apple Patched The Vulnerability
-------------------------------

 The researchers confirmed that Apple had patched the vulnerability with macOS Big Sur 11.6. Mentioning this bug’s impact in the [advisory](https://support.apple.com/en-mt/HT212804), Apple stated,

 
> A malicious application may bypass Gatekeeper checks.
> 
> 

 The tech giant confirmed to have fixed the flaw “with improved checks.”

 Since the update rolled out in September 2021, most users would have received the fix already. Nonetheless, those who haven’t updated their devices yet should now rush to receive the updates, especially considering that the PoC for this serious exploit is now public.

 Let us know your thoughts in the comments.

   


## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=at]] [[action.malware.name=Net]] [[action.malware.name=Ping]] [[action.malware.name=Ping]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Macos]] [[Poc]] [[Bin/sh]] [[Apps]] [[Latest Hacking News]]
#### CVE's
[[CVE-2021-30853]]

