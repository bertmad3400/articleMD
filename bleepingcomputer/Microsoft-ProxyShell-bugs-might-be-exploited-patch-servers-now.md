# Microsoft: ProxyShell bugs “might be exploited,” patch servers now!
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/microsoft/microsoft-proxyshell-bugs-might-be-exploited-patch-servers-now/)
+ Date: August 25, 2021
+ Author: Sergiu Gatlan


## Article:
![](https://www.bleepstatic.com/content/hl-images/2021/03/10/Exchange1.jpg)


Microsoft has finally published guidance today for the actively exploited ProxyShell vulnerabilities impacting multiple on-premises Microsoft Exchange versions.


[ProxyShell](https://www.bleepingcomputer.com/tag/proxyshell/) is a collection of three security flaws (patched in April and May) discovered by Devcore security researcher [Orange Tsai](https://twitter.com/orange_8361), who exploited them to compromise a Microsoft Exchange server during the [Pwn2Own 2021 hacking contest](https://www.bleepingcomputer.com/news/security/researchers-earn-1-2-million-for-exploits-demoed-at-pwn2own-2021/):


* [CVE-2021-34473](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473) - Pre-auth path confusion leads to ACL Bypass *(Patched in April by [KB5001779](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-april-13-2021-kb5001779-8e08f3b3-fc7b-466c-bbb7-5d5aa16ef064))*
* [CVE-2021-34523](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523) - Elevation of privilege on Exchange PowerShell backend *(Patched in April by [KB5001779](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-april-13-2021-kb5001779-8e08f3b3-fc7b-466c-bbb7-5d5aa16ef064))*
* [CVE-2021-31207](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-31207) - Post-auth Arbitrary-File-Write leads to RCE *(Patched in May by [KB5003435](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-may-11-2021-kb5003435-028bd051-b2f1-4310-8f35-c41c9ce5a2f1)**)*


Although Microsoft fully patched the ProxyShell bugs by May 2021, they didn't assign CVE IDs for the vulnerabilities until July, preventing some orgs with unpatched servers from discovering that they had vulnerable systems on their networks.


Microsoft silent on active attacks
----------------------------------


Security researchers and the US Cybersecurity and Infrastructure Security Agency (CISA) have already warned admins to patch their Exchange servers to defend against ongoing attacks using ProxyShell exploits that started in early August.


However, despite all previous warnings of active attacks, Microsoft failed to inform customers that their on-premises Exchange servers are under attack until today.


"This past week, security researchers discussed several ProxyShell vulnerabilities, including those which ***might*** be exploited on unpatched Exchange servers to deploy ransomware or conduct other post-exploitation activities," The Exchange Team said. *[emphasis ours]*


"If you have installed the May 2021 security updates or the July 2021 security updates on your Exchange servers, then you are protected from these vulnerabilities. Exchange Online customers are also protected (but must make sure that all hybrid Exchange servers are updated)."


Microsoft says that customers must install *AT LEAST ONE* of the supported latest cumulative updates and *ALL* applicable security updates to block ProxyShell attacks.


Per Microsoft, Exchange servers are vulnerable *if any of the following conditions are true*:


* The server is running an older, unsupported CU;
* The server is running security updates for older, unsupported versions of Exchange that were [released](https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020) in March 2021; or
* The server is running an older, unsupported CU, with the [March 2021 EOMT](https://msrc-blog.microsoft.com/2021/03/15/one-click-microsoft-exchange-on-premises-mitigation-tool-march-2021/) mitigations applied.


Active exploitation by multiple threat actors
---------------------------------------------


CISA's Monday warning that multiple threat actors are actively exploiting the ProxyShell vulnerabilities came after [similar](https://www.bleepingcomputer.com/news/security/dhs-orders-agencies-to-urgently-patch-or-disconnect-exchange-servers/) [ones](https://www.bleepingcomputer.com/news/security/cisa-gives-federal-agencies-5-days-to-find-hacked-exchange-servers/) [alerting](https://www.bleepingcomputer.com/news/security/cisa-gives-federal-agencies-until-friday-to-patch-exchange-servers/) organizations in March to defend their networks from a wave of attacks.


The March Exchange attacks were orchestrated by [Chinese state-backed hackers](https://www.bleepingcomputer.com/news/security/us-and-allies-officially-accuse-china-of-microsoft-exchange-attacks/) who hit [tens of thousands of organizations worldwide](https://www.bleepingcomputer.com/news/security/us-and-allies-officially-accuse-china-of-microsoft-exchange-attacks/) using exploits targeting four zero-day Exchange bugs collectively known as [ProxyLogon](https://www.bleepingcomputer.com/tag/proxylogon/).


Just as it happened in March, attackers are now [scanning for](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-scanned-for-proxyshell-vulnerability-patch-now/) and [hacking Microsoft Exchange servers using the ProxyShell vulnerabilities](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-are-getting-hacked-via-proxyshell-exploits/) after security researchers and threat actors [reproduced a working exploit](https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1).


While, in the beginning, the ProxyShell payloads dropped on Exchange servers were harmless, attackers are now [deploying LockFile ransomware](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-being-hacked-by-new-lockfile-ransomware/) payloads delivered across Windows domains compromised via [Windows PetitPotam exploits](https://www.bleepingcomputer.com/news/microsoft/new-petitpotam-attack-allows-take-over-of-windows-domains/).


To have an idea of the scale of the issue, security firm Huntress Labs recently [said](https://twitter.com/KyleHanslovan/status/1428804893423382532) it found more than 140 web shells deployed by attackers on over 1,900 compromised Microsoft Exchange servers by Friday last week.


Shodan is also tracking tens of thousands of Exchange servers vulnerable to ProxyShell attacks, most of them located in the US and Germany




> 
> More than 18% of Exchange servers remain unpatched for the ProxyShell vulnerability. Nearly 40% are vulnerable to CVE-2021-31206: <https://t.co/7yetz9GoJw> [pic.twitter.com/0r2AOQsibB](https://t.co/0r2AOQsibB)
> 
> 
> — Shodan (@shodanhq) [August 11, 2021](https://twitter.com/shodanhq/status/1425508828246953989?ref_src=twsrc%5Etfw)


"New surge in Microsoft Exchange server exploitation underway," NSA Cybersecurity Director Rob Joyce also [warned](https://twitter.com/NSA_CSDirector/status/1429035182049333249) over the weekend. "You must ensure you are patched and monitoring if you are hosting an instance."


The NSA [also reminded defenders](https://twitter.com/NSACyber/status/1429073988957970441?s=20) that [guidance published in March](https://twitter.com/NSACyber/status/1367887884917817351) on hunting for web shells can still be used to defend against ProxyShell ongoing attacks.


Until Microsoft releases further guidance on protecting and detecting vulnerable servers against exploitation, you can find detailed info on how to identify unpatched Exchange servers and how to detect exploitation attempts in [the blog post published by security researcher Kevin Beaumont](https://doublepulsar.com/multiple-threat-actors-including-a-ransomware-gang-exploiting-exchange-proxyshell-vulnerabilities-c457b1655e9c).




#### Tags:
[[ProxyShell]] [[Microsoft]] [[(Patched]] [[attacks.]] [[older,]] [[Bleeping Computer]]
