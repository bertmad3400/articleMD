# Hackers exploit Microsoft MSHTML bug to steal Google, Instagram creds
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/security/hackers-exploit-microsoft-mshtml-bug-to-steal-google-instagram-creds/)
+ Date: November 24, 2021
+ Author: Sergiu Gatlan


## Article:
![Hackers exploit Microsoft MSHTML bug to steal Google, Instagram creds](https://www.bleepstatic.com/content/hl-images/2021/11/24/silhouette.jpg)


A newly discovered Iranian threat actor is stealing Google and Instagram credentials belonging to Farsi-speaking targets worldwide using a new PowerShell-based stealer dubbed PowerShortShell by security researchers at SafeBreach Labs.


The info stealer is also used for Telegram surveillance and collecting system information from compromised devices that get sent to attacker-controlled servers together with the stolen credentials.


As SafeBreach Labs discovered, the attacks ([publicly reported in September](https://twitter.com/ShadowChasing1/status/1438126675565244417) on Twitter by the Shadow Chaser Group) started in July as spear-phishing emails.


They target Windows users with malicious Winword attachments that exploit a Microsoft MSHTML remote code execution (RCE) bug tracked as [CVE-2021-40444](https://www.bleepingcomputer.com/tag/cve-2021-40444/).


The PowerShortShell stealer payload is executed by a DLL downloaded on compromised systems. Once launched, the PowerShell script starts collecting data and screen snapshots, exfiltrating it to the attacker's command-and-control server.


"Almost half of the victims are located in the United States. Based on the Microsoft Word document content - which blames Iran’s leader for the 'Corona massacre' and the nature of the collected data, we assume that the victims might be Iranians who live abroad and might be seen as a threat to Iran's Islamic regime," [said](https://www.safebreach.com/blog/2021/new-powershortshell-stealer-exploits-recent-microsoft-mshtml-vulnerability-to-spy-on-farsi-speakers/) Tomer Bar, Director of Security Research at SafeBreach Labs.


"The adversary might be tied to Iran’s Islamic regime since the Telegram surveillance usage is typical of Iran's threat actors like Infy, Ferocious Kitten, and Rampant Kitten."



![Victims heat map](https://www.bleepstatic.com/images/news/u/1109292/2021/Victim_heat_map.png)*Victims heat map (SafeBreach Labs)*
The CVE-2021-40444 RCE bug impacting IE's MSTHML rendering engine has been exploited in the wild as a zero-day starting with August 18, more than two weeks before Microsoft issued a security advisory [with a partial workaround](https://www.bleepingcomputer.com/news/security/microsoft-shares-temp-fix-for-ongoing-office-365-zero-day-attacks/), and three weeks [before a patch was released](https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-windows-cve-2021-40444-mshtml-zero-day-bug/).


Most recently, it was exploited in conjunction with malicious advertisements [by the Magniber ransomware gang](https://www.bleepingcomputer.com/news/security/magniber-ransomware-gang-now-exploits-internet-explorer-flaws-in-attacks/) to infect targets with malware and encrypt their devices.


[Microsoft also said multiple threat actors](https://www.bleepingcomputer.com/news/microsoft/microsoft-windows-mshtml-bug-now-exploited-by-ransomware-gangs/), including ransomware affiliates, targeted this Windows MSHTML RCE bug using maliciously crafted Office documents delivered via phishing attacks.


These attacks abused the CVE-2021-40444 flaw "as part of an initial access campaign that distributed custom Cobalt Strike Beacon loaders."


The deployed beacons communicated with malicious infrastructure connected with several cybercrime campaigns, including but not limited to human-operated ransomware.



![CVE-2021-40444-attack-chain](https://www.bleepstatic.com/images/news/u/1109292/2021/CVE-2021-40444-attack-chain%20.png)*CVE-2021-40444 attack-chain (Microsoft)​​​​*
It's not surprising that more and more attackers are using CVE-2021-40444 exploits since threat actors started sharing tutorials and proof-of-concept exploits on hacking forums even before the bug was patched.


This likely allowed other threat actors and groups to start exploiting the security flaw in their own attacks.


The information shared online is simple to follow and makes it easy for anyone to create their own working version of a CVE-2021-40444 exploit, including a Python server that can distribute malicious documents and CAB files to compromised systems.


Using this info, BleepingComputer could also successfully reproduce the exploit in about 15 minutes, as demonstrated in [this video demo](https://vimeo.com/603308077).




#### Tags:
[[CVE-2021-40444]] [[Microsoft]] [[SafeBreach]] [[Bleeping Computer]]
