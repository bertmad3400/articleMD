# Microsoft: New critical Windows HTTP vulnerability is wormable
### Microsoft has patched a critical flaw tagged as wormable and found to impact the latest desktop and server Windows versions, including Windows 11 and Windows Server 2022.

## Information:
+ Source: Bleeping Computer
+ Link: https://www.bleepingcomputer.com/news/microsoft/microsoft-new-critical-windows-http-vulnerability-is-wormable/
+ Date: 2022-01-11T17:02:44-05:00
+ Author: Sergiu Gatlan


## Article:
![Article Image](https://www.bleepstatic.com/content/hl-images/2021/07/09/Windows_headpic.jpg)

![Wormable Windows HTTP vulnerability](https://www.bleepstatic.com/content/hl-images/2021/07/09/Windows_headpic.jpg)


Microsoft has patched a critical flaw tagged as wormable and found to impact the latest desktop and server Windows versions, including Windows 11 and Windows Server 2022.


The bug, tracked as [CVE-2022-21907](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21907) and patched during [this month's Patch Tuesday](https://www.bleepingcomputer.com/news/microsoft/microsoft-january-2022-patch-tuesday-fixes-6-zero-days-97-flaws/), was discovered in the HTTP Protocol Stack (HTTP.sys) used as a protocol listener for processing HTTP requests by the Windows Internet Information Services (IIS) web server.


Successful exploitation requires threat actors to send maliciously crafted packets to targeted Windows servers, which use the vulnerable HTTP Protocol Stack for processing packets.


Microsoft [recommends users prioritize patching](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21907#faq) this flaw on all affected servers since it could allow unauthenticated attackers to remotely execute arbitrary code in low complexity attacks and "in most situations," without requiring user interaction.


Mitigation available (for some Windows versions)
------------------------------------------------


Luckily, the flaw is not currently under active exploitation and there are no publicly disclosed proof of concept exploits.


Furthermore, on some Windows versions (i.e., Windows Server 2019 and Windows 10 version 1809), the HTTP Trailer Support feature containing the bug is not enabled by default.


According to Microsoft, the following Windows registry key has to be configured on these two Windows versions to introduce the vulnerability: 



```
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\HTTP\Parameters\ 

"EnableTrailerSupport"=dword:00000001
```

Disabling the HTTP Trailer Support feature will protect systems running the two versions, but this mitigation does not apply to other impacted Windows releases.


Potential targets likely safe from attacks
------------------------------------------


While home users are yet to apply today's security updates, most companies will likely be protected from CVE-2022-21907 exploits, given that they don't commonly run the latest released Windows versions.


In the last two years, Microsoft has patched several other wormable bugs, impacting the Windows DNS Server (also known as [SIGRed](https://www.bleepingcomputer.com/tag/sigred/)), the Remote Desktop Services (RDS) platform (aka [BlueKeep](https://www.bleepingcomputer.com/tag/bluekeep/)), and the Server Message Block v3 protocol (aka [SMBGhost](https://www.bleepingcomputer.com/tag/smbghost/)).


Redmond also addressed another Windows HTTP RCE vulnerability in May 2021 (tracked as CVE-2021-31166 and also [tagged as wormable](https://www.bleepingcomputer.com/news/security/wormable-windows-http-vulnerability-also-affects-winrm-servers/)), for which security researchers [released demo exploit code](https://www.bleepingcomputer.com/news/security/exploit-released-for-wormable-windows-http-vulnerability/) that could trigger blue screens of death.


However, threat actors are yet to exploit them to create wormable malware capable of spreading between vulnerable systems running vulnerable Windows software.





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=at]] [[action.malware.name=Net]] [[action.malware.name=Reg]] [[action.malware.name=Tor]]

#### Industry:
[[victim.industry.name=Accomodation]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Windows]] [[Http]] [[Microsoft]] [[Wormable]] [[Bleeping Computer]]
#### CVE's
[[CVE-2022-21907]] [[CVE-2021-31166]]

