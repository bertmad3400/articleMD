#  600K WordPress sites impacted by critical plugin RCE vulnerability
### Essential Addons for Elementor, a popular WordPress plugin used in over a million sites, has been found to have a critical remote code execution (RCE) vulnerability in version 5.0.4 and older.

## Information:
+ Source: Bleeping Computer
+ Link: https://www.bleepingcomputer.com/news/security/600k-wordpress-sites-impacted-by-critical-plugin-rce-vulnerability/
+ Date: 2022-01-31T15:35:52-05:00
+ Author: Bill Toulas


## Article:
![Article Image](https://www.bleepstatic.com/content/hl-images/2021/11/10/WordPress.jpg)

![wordpress](https://www.bleepstatic.com/content/hl-images/2021/11/10/WordPress.jpg?rand=1920971633)


Essential Addons for Elementor, a popular WordPress plugin used in over a million sites, has been found to have a critical remote code execution (RCE) vulnerability in version 5.0.4 and older.


The flaw allows an unauthenticated user to perform a local file inclusion attack, such as a PHP file, to execute code on the site.


"The local file inclusion vulnerability exists due to the way user input data is used inside of PHP's include function that are part of the ajax\_load\_more and ajax\_eael\_product\_gallery functions." explains PatchStack researchers who discovered the vulnerability.


The only prerequisite for the attack is for the site to have the "dynamic gallery" and "product gallery" widgets enabled so that a none token check is present.



![Sample of code that triggers the flaw](https://www.bleepstatic.com/images/news/u/1220909/Code%20and%20Details/trigger.jpg)**Sample of code that triggers the flaw**  
*Source: Patchstack*
Two failed patching attempts
----------------------------


Researcher Wai Yan Muo Thet discovered the vulnerability on January 25, 2022, and the plugin developer already knew about its existence at that time.


In fact, the author had released version 5.0.3 to address this issue by applying a "sanitize\_text\_field" function on the user input data. However, this sanitization doesn't prevent the inclusion of local payloads.


The second attempt was version 5.0.4, which added the "sanitize\_file\_name" function and attempted to remove special characters, dots, slashes, and anything that could be used for overriding the text sanitization step.



![Function to sanitize text field](https://www.bleepstatic.com/images/news/u/1220909/Code%20and%20Details/sanitization.jpg)**Function to sanitize text field**  
*Source: Patchstack*
This was the version that [Patchstack tested](https://patchstack.com/articles/critical-vulnerability-fixed-in-essential-addons-for-elementor-plugin/) and found vulnerable, so they informed the developer that the fix hadn't mitigated the issue sufficiently.


Eventually, the author released version 5.0.5 that implemented PHP's "realpath" function, preventing malicious pathname resolutions.


Update and mitigate
-------------------


This version was released last week, on January 28, 2022, and at this time has only been installed approximately 380,000 times according to WordPress' [download statistics](https://api.wordpress.org/stats/plugin/1.0/downloads.php?slug=essential-addons-for-elementor-lite&limit=15).


With the plugin installed in [over 1 million WordPress sites](https://wordpress.org/plugins/essential-addons-for-elementor-lite/), that means there are over 600K sites that have not applied the security update yet.


If you are among the many that use Essential Addons for Elementor, you can [get the latest version from here](https://wordpress.org/plugins/essential-addons-for-elementor-lite/) or apply the update directly from the WP dashboard.


To prevent actors from leveraging local file inclusion flaws even when they can't be directly mitigated, follow these steps:


* Save your file paths in a secure database and give an ID for every single one.
* Use verified and secured allowlist files and ignore everything else.
* Don't include files on a web server that can be compromised, but use a database instead.
* Make the server send download headers automatically instead of executing files in a specified directory.





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=at]] [[action.malware.name=Tor]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Wordpress]] [[Plugin]] [[Php]] [[Patchstack]] [[Bleeping Computer]]

