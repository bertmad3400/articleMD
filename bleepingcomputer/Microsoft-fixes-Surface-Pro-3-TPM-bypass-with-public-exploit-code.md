# Microsoft fixes Surface Pro 3 TPM bypass with public exploit code
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/microsoft/microsoft-fixes-surface-pro-3-tpm-bypass-with-public-exploit-code/)
+ Date: October 19, 2021
+ Author: Sergiu Gatlan


## Article:
![Microsoft fixes Surface Pro 3 TPM bypass with public exploit code](https://www.bleepstatic.com/content/hl-images/2021/09/05/Microsoft.jpg)


Microsoft has patched a security feature bypass vulnerability impacting Surface Pro 3 tablets, enabling threat actors to introduce malicious devices within enterprise environments.


The security flaw, dubbed [**TPM Carte Blanche**](https://github.com/google/security-research/blob/master/pocs/bios/tpm-carte-blanche/writeup.md) by Google security researchers who discovered it, is tracked as CVE-2021-42299 and can be exploited in high complexity attacks by attackers with access to the owner's credentials or physical access to the device.


[Device Health Attestation](https://docs.microsoft.com/en-us/windows-server/security/device-health-attestation) is a cloud and on-premises service that validates TPM and PCR logs for endpoints and informs Mobile Device Management (MDM) solutions if Secure Boot, BitLocker, and Early Launch Antimalware (ELAM) are enabled, Trusted Boot is correctly signed, and more.


By exploiting CVE-2021-42299, attackers can poison the TPM and PCR logs to obtain false attestations, allowing them to compromise the Device Health Attestation validation process.


"Devices use Platform Configuration Registers (PCRs) to record information about device and software configuration to ensure that the boot process is secure. Windows uses these PCR measurements to determine device health," Microsoft explains.


"A vulnerable device can masquerade as a healthy device by extending arbitrary values into Platform Configuration Register (PCR) banks."


"The attacker can prepare a bootable Linux USB stick to minimize the interactions required with the target device (e.g., as an Evil Maid attack)," [added](https://github.com/google/security-research/blob/master/pocs/bios/tpm-carte-blanche/writeup.md#exploitation) Chris Fenner, the Google software engineer who found the bug.


Advisory published the same day PoC code was published
------------------------------------------------------


Fenner also published [proof-of-concept (Poc) exploit code](https://github.com/google/security-research/tree/master/pocs/bios/tpm-carte-blanche) demonstrating how the flaw could be exploited on Monday.


Even though Microsoft lists the CVE-2021-42299 advisory as published during Patch Tuesday, on October 12th, it posted it on Microsoft Security Response Center's website the same day Fenner's PoC was published on GitHub.


Furthermore, even though a PoC exploit for the vulnerability has been published, Microsoft doesn't list it as a publicly disclosed flaw.


Microsoft confirmed Fenner's findings that the Surface Pro 3 is exposed to attacks if not patched. More recent Surface devices such as the Surface Pro 4, Surface Book are not vulnerable.


While the Surface Pro 3 was released in June 2014 and discontinued in November 2016, Redmond says devices from other vendors could also be vulnerable to TPM Carte Blanche attacks and that it attempted to notify all affected vendors of the issue.


"It is possible that other devices, including non-Microsoft devices, using a similar BIOS may also be vulnerable," Microsoft [said](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-42299).


A Microsoft spokesperson was not available for comment when contacted by BleepingComputer earlier today for more details.




#### Tags:
[[Microsoft]] [[PCR]] [[PoC]] [[Bleeping Computer]]
