# Exploit released for Microsoft Exchange RCE bug, patch now
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/security/exploit-released-for-microsoft-exchange-rce-bug-patch-now/)
+ Date: November 22, 2021
+ Author: Sergiu Gatlan


## Article:
![Exploit released for Microsoft Exchange RCE bug, patch now](https://www.bleepstatic.com/content/hl-images/2021/09/28/Exchange_headpic.jpg)


Proof-of-concept exploit code has been released online over the weekend for an actively exploited high severity vulnerability impacting Microsoft Exchange servers.


The security bug tracked as [CVE-2021-42321](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-42321) impacts on-premises Exchange Server 2016 and Exchange Server 2019 (including those used by customers in Exchange Hybrid mode) and was patched by Microsoft during this month's Patch Tuesday.


Successful exploitation allows authenticated attackers to execute code remotely on vulnerable Exchange servers.


On Sunday, almost two weeks [after the CVE-2021-42321 patch was issued](https://www.bleepingcomputer.com/news/microsoft/microsoft-urges-exchange-admins-to-patch-bug-exploited-in-the-wild/), researcher [Janggggg](https://twitter.com/testanull) published a proof-of-concept exploit for the Exchange post-auth RCE bug.


"This PoC just pop mspaint.exe on the target, can be use to recognize the signature pattern of a successful attack event," the researcher [said](https://twitter.com/testanull/status/1462363736815988744).


Admins warned to patch immediately
----------------------------------


"We are aware of limited targeted attacks in the wild using one of the vulnerabilities (CVE-2021-42321), which is a post-authentication vulnerability in Exchange 2016 and 2019," Microsoft said.


"Our recommendation is to install these updates immediately to protect your environment," the company said, urging Exchange admins to patch the bug exploited in the wild.


If you haven't yet patched this security vulnerability in your on-premises servers, you can generate a quick inventory of all Exchange servers in your environment that need updating using the latest version of the [Exchange Server Health Checker script](https://aka.ms/ExchangeHealthChecker).


To check if any of your vulnerable Exchange servers have already been hit by CVE-2021-42321 exploitation attempts, you have to run this PowerShell query on each Exchange server to check for specific events in the Event Log:



![Exchange Server update paths](https://www.bleepstatic.com/images/news/u/1109292/2021/Exchange_Server_update_paths.jpg)*Exchange Server CVE-2021-42321 update paths (Microsoft)*
On-premises Exchange servers under attack
-----------------------------------------


Exchange admins have dealt with two massive waves of attacks since the start of 2021, targeting the ProxyLogon and ProxyShell security vulnerabilities.


State-backed and financially motivated threat actors [used ProxyLogon exploits](https://www.bleepingcomputer.com/news/security/microsoft-fixes-actively-exploited-exchange-zero-day-bugs-patch-now/) to deploy web shells, cryptominers, ransomware, and other malware starting with early March.


In these attacks, they targeted more than a quarter of a million Microsoft Exchange servers, belonging to tens of thousands of organizations around the world.


Four months later, the US and its allies, including the EU, the UK, and NATO, [officially blamed China](https://www.bleepingcomputer.com/news/security/us-and-allies-officially-accuse-china-of-microsoft-exchange-attacks/) for these widespread Microsoft Exchange hacking attacks.


In August, threat actors also began [scanning for](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-scanned-for-proxyshell-vulnerability-patch-now/) and [breaching Exchange servers](https://www.bleepingcomputer.com/news/microsoft/microsoft-exchange-servers-are-getting-hacked-via-proxyshell-exploits/) by exploiting ProxyShell vulnerabilities after security researchers [reproduced a working exploit](https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1).


Even though payloads dropped using ProxyShell exploits were harmless in the beginning, attackers later switched to [deploying LockFile ransomware](https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-being-hacked-by-new-lockfile-ransomware/) payloads across Windows domains hacked using [Windows PetitPotam exploits](https://www.bleepingcomputer.com/news/microsoft/new-petitpotam-attack-allows-take-over-of-windows-domains/).


With this latest vulnerability (CVE-2021-42321), researchers are already seeing attackers scan for and attempt to compromise vulnerable systems.




> 
> Just caught somebody in the wild trying to exploit CVE-2021-42321 to execute code on MailPot, by chaining it with ProxyShell (no, I don't know why either - it doesn't work).
> 
> 
> — Kevin Beaumont (@GossiTheDog) [November 22, 2021](https://twitter.com/GossiTheDog/status/1462831929955438597?ref_src=twsrc%5Etfw)


As Microsoft Exchange has become a popular target for threat actors to gain initial access to a targets' networks, it is strongly advised to keep servers up-to-date with the latest security patches. 




#### Tags:
[[Microsoft]] [[CVE-2021-42321]] [[ProxyShell]] [[Bleeping Computer]]
