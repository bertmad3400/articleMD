# Microsoft disables Excel 4.0 macros by default to block malware
### ​Microsoft has announced that Excel 4.0 (XLM) macros will now be disabled by default to protect customers from malicious documents.

## Information:
+ Source: Bleeping Computer
+ Link: https://www.bleepingcomputer.com/news/microsoft/microsoft-disables-excel-40-macros-by-default-to-block-malware/
+ Date: 2022-01-21T10:56:21-05:00
+ Author: Sergiu Gatlan


## Article:
![Article Image](https://www.bleepstatic.com/content/hl-images/2022/01/21/Excel.jpg)

![Microsoft Excel](https://www.bleepstatic.com/content/hl-images/2022/01/21/Excel.jpg)


​Microsoft has announced that Excel 4.0 (XLM) macros will now be disabled by default to protect customers from malicious documents.


In October, the company first revealed in a Microsoft 365 message center update that it [would disable XLM macros in all tenants](https://www.bleepingcomputer.com/news/microsoft/microsoft-is-disabling-excel-40-macros-by-default-to-protect-users/) if the users or admins hadn't manually toggled the feature on or off.


[Starting July 2021](https://techcommunity.microsoft.com/t5/excel-blog/restrict-usage-of-excel-4-0-xlm-macros-with-new-macro-settings/ba-p/2528450), Windows admins could also use group policies and users the 'Enable XLM macros when VBA macros are enabled' setting from the Excel Trust Center to disable this feature manually.


"In July of 2021, we released a new Excel Trust Center setting option to restrict the usage of Excel 4.0 (XLM) macros," [said](https://techcommunity.microsoft.com/t5/excel-blog/excel-4-0-xlm-macros-now-restricted-by-default-for-customer/ba-p/3057905) Catherine Pidgeon, a Principal Program Manager Lead at Microsoft, earlier this week in a Tech Community blog post.


"As planned, we have now made this setting the default when opening Excel 4.0 (XLM) macros. This will help our customers protect themselves against related security threats."


Admins can configure how Excel macros are allowed to run using Group Policy settings, Cloud policies, and ADMX policies.


They can also block all Excel XLM macro use in their environments (including new user-created files) by toggling on the "Prevent Excel from running XLM macros" Group Policy, configurable via Group Policy Editor or registry key.


Right now, XLM macros are disabled by default in the September fork, Excel version 16.0.14527.20000 and newer available in the:


* Current Channel builds 2110 or greater (first released in October)
* Monthly Enterprise Channel builds 2110 or greater (first released in December)
* Semi-Annual Enterprise Channel (Preview) builds 2201 or greater (first ships in March 2022)
* Semi-Annual Enterprise Channel builds 2201 or greater (will ship July 2022)


![XLS document with obfuscated Excel 4.0 macro](https://www.bleepstatic.com/images/news/Microsoft/m/microsoft-365/disable-excel-4-macros/malicious-excel_4-document.jpg)**XLS document with obfuscated Excel 4.0 macro**
Even though VBA-based macros were introduced with the release of Excel 5.0, threat actors are still using them more than two decades later to create documents that deploy malware or perform other malicious behavior.


Malicious campaigns using XLM macros to push malware have been observed downloading and installing [TrickBot](https://twitter.com/h2jazi/status/1331342523462258696), [Zloader](https://twitter.com/elceef/status/1392177026078056455), [Qbot](https://twitter.com/elceef/status/1396916046188195849), [Dridex](https://twitter.com/jcarndt/status/1260998505541353472), and many other strains on victims' computers.


Microsoft also [silently added a Group Policy in October 2019](https://www.bleepingcomputer.com/news/microsoft/office-365-admins-can-now-block-malicious-microsoft-query-iqy-files/) that allows admins to block Excel users from opening untrusted (and potentially malicious) Microsoft Query files with IQY, OQY, DQY, and RQY extensions.


Such files have been weaponized in numerous malicious attacks to deliver [remote access Trojans](https://www.bleepingcomputer.com/news/security/malspam-campaigns-using-iqy-attachments-to-bypass-av-filters-and-install-rats/) and [malware loaders](https://www.bleepingcomputer.com/news/security/necurs-botnet-pushing-new-marap-malware/) since early 2018.





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=Dridex]] [[action.malware.name=njRAT]] [[action.malware.name=QakBot]] [[action.malware.name=Reg]] [[action.malware.name=Tor]] [[action.malware.name=TrickBot]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Xlm]] [[Microsoft]] [[(xlm)]] [[Admins]] [[(first]] [[Malware]] [[Bleeping Computer]]

