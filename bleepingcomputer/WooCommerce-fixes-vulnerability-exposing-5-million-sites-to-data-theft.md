# WooCommerce fixes vulnerability exposing 5 million sites to data theft
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/security/woocommerce-fixes-vulnerability-exposing-5-million-sites-to-data-theft/)
+ Date: July 15, 2021
+ Author: Ionut Ilascu


## Article:
![WooCommerce updated to fix unauthenticated SQL injection](https://www.bleepstatic.com/content/hl-images/2021/07/15/WooCommerce1.jpg)


WooCommerce, the popular e-commerce plugin for the WordPress content management system has been updated to patch a serious vulnerability that could be exploited without authentication.


Administrators are urged to install the latest release of the platform as the flaw affects more than 90 versions starting with 5.5.0.



Owned by Automattic, the company behind the WordPress.com blogging service, the [WooCommerce plugin](https://wordpress.org/plugins/woocommerce/) has more than five million installations.


### Improper sanitization


In a post today, the WooCommerce team says that the bug is critical and it also affects the [WooCommerce Blocks](https://wordpress.org/plugins/woo-gutenberg-products-block/) plugin for showing products on posts and pages.


Both plugins received an update to version 5.5.1. The fix has been rolling out to affected versions (WooCommerce 3.3 through 5.5 and WooCommerce Blocks 2.5 through 5.5).


The vulnerability has yet to receive a tracking number but its [severity score](https://patchstack.com/database/vulnerability/woocommerce/wordpress-woocommerce-plugin-5-5-0-sql-injection-sqli-vulnerability) has been calculated at 8.2 out of 10 by Patchstack, a company that protects WordPress sites from plugin vulnerabilities.


[Oliver Sild](https://twitter.com/OliverSild), the founder and CEO of Patchstack, provides some technical details about the bug after noting that the patch eliminates the flaw by modifying two PHP files that allowed injecting malicious code in SQL statements without the need to authenticate.



![Bug possible due to code in two WooCommerce core files](https://www.bleepstatic.com/images/news/u/1100723/2021/YB5zGIh.png)source: [Patchstack](https://patchstack.com/woocommerce-sql-injection-vulnerability/)
The injection was possible because of “a webhook search function that injected the search parameter into a SQL query without using a prepared statement.”


Sild explains that despite the use of the *sanitize\_text\_field* and *esc\_like* functions, the latter could be used without a prepared statement, which no longer happens in version 5.5.1.


As for the lack of authentication, the researcher says that it was due to the improper escape of the *$attributes* parameter in a public-facing endpoint that did not require authentication.


“The *$attributes* parameter in this endpoint (line 86) is taken from the user input and then processed and injected into a SQL query that was not properly escaped,” Sild says.


The researcher clarified further saying that “the only sanitization against this parameter was the *sanitize\_title* function (through *wc\_sanitize\_taxonomy\_name*). However, this does not provide sufficient protection.”


### Exploitation risk


Affected WooCommerce installations are currently receiving the patch automatically with the help of the WordPress.org Plugin Team. Sites on the WordPress.com blogging platform have already received the fix.


At the same time, the WooCommerce team sent out an [email](https://mailchi.mp/woocommerce/action-required-critical-vulnerability-woocommerce) informing users about the vulnerability and that applying it is a critical precaution.


An attacker taking advantage of this SQL injection flaw could obtain store-related information, administrative details, and data about orders and customers.


Patchstack has not seen any attempts to exploit this vulnerability in the wild but threat actors may jump at the occasion before the fix reaches more sites.


WooCommerce strongly recommends updating to the latest version followed by changing the passwords.


The developers learned about the bug after a security researcher named [Josh](https://hackerone.com/jl-dos?type=user) reported it through [Automattic's bug bounty program](https://hackerone.com/automattic?type=team) on HackerOne. As per the rewards info for the program and given that WooCommerce marked the flaw as critical, the researcher stands to get a $500 bounty.




#### Tags:
[[WooCommerce]] [[5]] [[WordPress]] [[plugin]] [[Patchstack]] [[SQL]] [[Bleeping Computer]]
