# Windows PetitPotam vulnerability gets an unofficial free patch
### 

## Information:
+ Source: Bleeping Computer
+ Link: [article](https://www.bleepingcomputer.com/news/microsoft/windows-petitpotam-vulnerability-gets-an-unofficial-free-patch/)
+ Date: August 6, 2021
+ Author: Sergiu Gatlan


## Article:
![Windows PetitPotam vulnerability gets an unofficial free patch](https://www.bleepstatic.com/content/hl-images/2021/05/26/Microsoft-Defender.jpg)


A free unofficial patch is now available to block attackers from taking over domain controllers and compromising entire Windows domains via PetitPotam NTLM relay attacks.


The [PetitPotam attack vector](https://www.bleepingcomputer.com/news/microsoft/new-petitpotam-attack-allows-take-over-of-windows-domains/) that forces Windows machines to authenticate against threat actors' malicious NTLM relay servers using the Microsoft Encrypting File System Remote Protocol ([EFSRPC](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-efsr/08796ba8-01c8-4872-9221-1000ec2eff31)) was disclosed last month by security researcher Gilles Lionel (aka [Topotam](https://twitter.com/topotam77)).


Using this attack method, threat actors can completely take over Windows domains, allowing them to push new group policies and deploying malware (including ransomware) on all endpoints.


In July, Microsoft released a [security advisory](http://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429) explaining how to mitigate NTLM relay attacks targeting Active Directory Certificate Services (AD CS) and saying that vulnerable servers are not correctly configured.


While Microsoft's advisory is designed to help prevent NTLM relay attacks, it does not provide any guidance on how to actually block PetitPotam, which could also be used as a vector for other attacks such as NTLMv1 downgrades.



Free PetitPotam micropatch available
------------------------------------


The [0patch micropatching service](https://0patch.com/) has released today a free unofficial patch that can be used to block PetitPotam NTLM relay attacks on the following Windows version:


* **Windows Server 2019** (updated with July 2021 Updates)
* **Windows Server 2016** (updated with July 2021 Updates)
* **Windows Server 2012 R2** (updated with July 2021 Updates)
* **Windows Server 2008 R2** (updated with January 2020 Updates, no Extended Security Updates)


No micropatch was issued for Windows Server 2012 (non R2), Windows Server 2008 (non R2), and Windows Server 2003 because, based on 0patch's analysis, these releases are not impacted by PetitPotam.


To install the micropatch on your system, you first need to [register a 0patch account](https://central.0patch.com/) and then install the [0patch agent](https://0patch.com/). 


"Micropatches for this vulnerability are, as always, automatically downloaded and applied to all affected computers (unless your policy prevents that), and will be free until Microsoft has issued an official fix," 0patch co-founder Mitja Kolsek [said](https://blog.0patch.com/2021/08/free-micropatches-for-petitpotam.html).


If you can't immediately deploy one of these temporary patches, you can also defend against PetitPotam attacks [using NETSH RPC filters](https://www.bleepingcomputer.com/news/microsoft/windows-petitpotam-attacks-can-be-blocked-using-new-method/) that block remote access to the MS-EFSRPC API, effectively removing the unauthenticated PetitPotam attack vector.




#### Tags:
[[Windows]] [[PetitPotam]] [[NTLM]] [[0patch]] [[Microsoft]] [[(updated]] [[Updates)]] [[micropatch]] [[Bleeping Computer]]
