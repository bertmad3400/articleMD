# Fake Windows 11 upgrade installers infect you with RedLine malware
### Threat actors have started distributing fake Windows 11 upgrade installers to users of Windows 10, tricking them into downloading and executing RedLine stealer malware.

## Information:
+ Source: Bleeping Computer
+ Link: https://www.bleepingcomputer.com/news/security/fake-windows-11-upgrade-installers-infect-you-with-redline-malware/
+ Date: 2022-02-09T07:58:50-05:00
+ Author: Bill Toulas


## Article:
![Article Image](https://www.bleepstatic.com/content/hl-images/2022/02/09/Windows__11.jpg)

![Windows](https://www.bleepstatic.com/content/hl-images/2022/02/09/Windows__11.jpg)


Threat actors have started distributing fake Windows 11 upgrade installers to users of Windows 10, tricking them into downloading and executing RedLine stealer malware.


The timing of the attacks coincides with the moment that Microsoft announced Windows 11's [broad deployment phase](https://www.bleepingcomputer.com/news/microsoft/microsoft-windows-11-now-in-broad-deployment-for-eligible-devices/), so the attackers were well-prepared for this move and waited for the right moment to maximize their operation's success.


RedLine stealer is currently [the most widely deployed](https://www.bleepingcomputer.com/news/security/2easy-now-a-significant-dark-web-marketplace-for-stolen-data/) password, browser cookies, credit card, and cryptocurrency wallet info grabber, so its infections can have dire consequences for the victims.


The campaign
------------


[According to researchers at HP](https://threatresearch.ext.hp.com/redline-stealer-disguised-as-a-windows-11-upgrade/), who have spotted this campaign, the actors used the seemingly legitimate “windows-upgraded.com” domain for the malware distribution part of their campaign.


The site appears like a genuine Microsoft site and, if the visitor clicked on the ‘Download Now’ button, they received a 1.5 MB ZIP archive named “Windows11InstallationAssistant.zip,” fetched directly from a Discord CDN.



![Phony website used for malware distribution](https://www.bleepstatic.com/images/news/u/1220909/Website%20snaps/site.png)*Fake website used for malware distribution (HP)*
Decompressing the file results in a folder of 753MB of size, showcasing an impressive compression ratio of 99.8%, achieved thanks to the presence of padding in the executable.


When the victim launches the executable in the folder, a PowerShell process with an encoded argument starts.


Next, a cmd.exe process is launched with a timeout of 21 seconds, and after that expires, a .jpg file is fetched from a remote web server.


This file contains a DLL with contents arranged in reverse form, possibly to evade detection and analysis.


Finally, the initial process loads the DLL and replaces the current thread context with it. That DLL is a RedLine stealer payload that connects to the command-and-control server via TCP to get instructions on what malicious tasks it has to run next on the newly compromised system.



![RedLine execution and loading chain](https://www.bleepstatic.com/images/news/u/1220909/Diagrams/redline_06.png)*RedLine execution and loading chain (HP)*
Outlook
-------


Although the distribution site is down now, nothing stops the actors from setting up a new domain and restarting their campaign. In fact, this is very likely already happening in the wild.


Windows 11 is a major upgrade that many Windows 10 users cannot get from the official distribution channels due to hardware incompatibilities, something that malware operators see as an excellent opportunity for finding new victims.


As BleepingComputer reported in January, threat actors are also leveraging [Windows' legitimate update clients](https://www.bleepingcomputer.com/news/security/lazarus-hackers-use-windows-update-to-deploy-malware/) to execute malicious code on compromised Windows systems, so the tactics reported by HP are hardly surprising at this point.


Remember, these dangerous sites are promoted via forum and social media posts or instant messages, so don’t trust anything but the official Windows upgrade system alerts.





## Tags:

#### Action:
[[action.malware.name=at]] [[action.malware.name=at]] [[action.malware.name=cmd]] [[action.malware.name=cmd]] [[action.malware.name=Ping]] [[action.malware.name=Ping]] [[action.malware.name=Tor]]

#### Location:
[[victim.country.name=Mali]] [[victim.continent.name=Africa]] [[victim.city.name=]] [[victim.country.name=Haiti]] [[victim.continent.name=North and Central America]]

### Autogenerated Tags:
[[Windows]] [[Malware]] [[Dll]] [[Bleeping Computer]]

